# ================================================================================================
# üé® PROJECT-SPECIFIC CONFIGURATION (90-project.env)
# ================================================================================================
#
# Purpose: Project-specific overrides and customizations
# Load Order: 90 (near end, overrides all earlier files)
#
# This file is for PROJECT-SPECIFIC configuration that differs from go-fortress defaults.
# It is tracked in git and synced by go-broadcast.
#
# Use this file to:
# - Override default tool versions for compatibility
# - Customize coverage thresholds or exclusions
# - Adjust workflow behavior for this specific project
# - Set project-specific feature flags
# - Configure tool behavior specific to this codebase
#
# DO NOT USE FOR:
# - Local developer preferences (use 99-local.env instead)
# - Secrets or API keys (use GitHub Secrets)
# - Temporary testing overrides (use 99-local.env instead)
#
# Load Order: This file loads after all 00-* and 10-* and 20-* files,
# so any variables set here will override the defaults from those files.
#
# ================================================================================================

# ================================================================================================
# üéØ GO VERSION CONFIGURATION
# ================================================================================================

# Project Go versions (overrides 00-core.env defaults)
GO_PRIMARY_VERSION=1.25.x
GO_SECONDARY_VERSION=1.25.x

# ================================================================================================
# üìù PROJECT OVERRIDES
# ================================================================================================

# Automerge Labels Configuration
# When using --automerge flag, these labels will be added to created PRs
# Comma-separated list of labels to apply for automatic merging
GO_BROADCAST_AUTOMERGE_LABELS=automerge

# AI generates intelligent PR descriptions and commit messages based on diff analysis.
# Disabled by default. All AI failures fall back to static templates silently.
# Uses Google Genkit SDK with support for Anthropic, OpenAI, and Google providers.

# Master switch - enables AI infrastructure (disabled by default)
GO_BROADCAST_AI_ENABLED=true

# Enable AI for PR body generation
GO_BROADCAST_AI_PR_ENABLED=true

# Enable AI for commit message generation
GO_BROADCAST_AI_COMMIT_ENABLED=true

# Provider: anthropic, openai, google
GO_BROADCAST_AI_PROVIDER=anthropic

# API key (or use provider-specific: ANTHROPIC_API_KEY, OPENAI_API_KEY, GEMINI_API_KEY)
# DO NOT USE THIS IN PUBLIC REPOSITORIES, USE ENVIRONMENT SECRETS INSTEAD
# GO_BROADCAST_AI_API_KEY=

# Model override (uses provider defaults if empty)
# anthropic: claude-sonnet-4-5-20250929 | openai: gpt-5.2 | google: gemini-3-pro-preview
GO_BROADCAST_AI_MODEL=

# Generation parameters
GO_BROADCAST_AI_MAX_TOKENS=5000
GO_BROADCAST_AI_TIMEOUT=30
GO_BROADCAST_AI_TEMPERATURE=0.3

# Diff truncation (prevents token limit issues)
GO_BROADCAST_AI_DIFF_MAX_CHARS=4000
GO_BROADCAST_AI_DIFF_MAX_LINES_PER_FILE=50

# Response caching (reduces API calls for identical diffs across repos)
GO_BROADCAST_AI_CACHE_ENABLED=true
GO_BROADCAST_AI_CACHE_TTL=3600
GO_BROADCAST_AI_CACHE_MAX_SIZE=1000

# Retry settings (handles transient failures)
GO_BROADCAST_AI_RETRY_MAX_ATTEMPTS=3
GO_BROADCAST_AI_RETRY_INITIAL_DELAY=1
GO_BROADCAST_AI_RETRY_MAX_DELAY=10

# Error handling behavior
# When true, AI failures will cause sync to fail with an error (shows which API key env var was used)
# When false (default), AI failures silently fall back to static templates
GO_BROADCAST_AI_FAIL_ON_ERROR=false

# Diff Debugging
# GO_BROADCAST_DEBUG_DIFF_PATH=/tmp/debug-diff.txt

# ================================================================================================
# üìä GO-COVERAGE CONFIGURATION
# ================================================================================================

# Custom Coverage Exclusions
GO_COVERAGE_EXCLUDE_PATHS=test/,vendor/,testdata/,examples/,plans/,docs/

# Skip URL Checks in Coverage Reports (true/false)
# Speed up deployment by skipping URL checks
GO_COVERAGE_SKIP_URL_CHECKS=true

# Google Analytics Configuration (for coverage pages)
GOOGLE_ANALYTICS_ID=G-VKFVWG6GXM

# Timeouts for coverage logo generation and HTTP requests (adjust as needed for CI performance)
GO_COVERAGE_LOGO_TIMEOUT=15s
GO_COVERAGE_LOGO_HTTP_TIMEOUT=10s

# ================================================================================================
# ü™ù GO-PRE-COMMIT CONFIGURATION
# ================================================================================================

# Custom Pre-Commit Configuration (only look at changed files)
GO_PRE_COMMIT_ALL_FILES=false

# ================================================================================================
# ü™Ñ MAGE-X CONFIGURATION
# ================================================================================================

MAGE_X_GO_VERSION=1.25.x
MAGE_X_GO_SECONDARY_VERSION=1.25.x

# Exclude specific tags from auto-discovery (comma-separated)
MAGE_X_AUTO_DISCOVER_BUILD_TAGS_EXCLUDE=go1,go1.18,bench_heavy,race,performance,integration

# Exclude magefiles for now, prebuild fails
MAGE_X_BUILD_EXCLUDE_PATTERN=magefiles
MAGE_X_TEST_EXCLUDE_MODULES=magefiles

# Test timeout - override default 10m to match CI configuration
# Prevents premature SIGKILL during race+coverage tests
MAGE_X_TEST_TIMEOUT=30m

# Fuzz test timeout configuration
# Prevents "context deadline exceeded" errors by calculating appropriate timeouts
# based on seed corpus size and validation complexity.
#
# Timeout formula: timeout = fuzzTime + (seedCount √ó OVERHEAD_PER_SEED) + BASELINE_BUFFER
# Current seed counts:
#   - FuzzConfigParsing: 31 seeds (internal/config/fuzz_test.go)
#   - FuzzRepoNameValidation: 51 seeds (internal/git/fuzz_test.go)
#   - FuzzBranchNameValidation: 57 seeds (internal/git/fuzz_test.go)
# Example calculation (worst case): 5s + (57 √ó 500ms) + 90s = 123.5s
#
# These values match MAGE-X defaults but are explicitly set to document our requirements.

# Buffer time for test setup/teardown and Go runtime overhead
MAGE_X_FUZZ_BASELINE_BUFFER=120s

# Time per seed during baseline gathering phase (Go runs all seeds before fuzzing)
# go-broadcast has complex validation: security checks, YAML parsing, context handling
MAGE_X_FUZZ_BASELINE_OVERHEAD_PER_SEED=800ms

# Minimum timeout for any fuzz test (increased from 90s default to handle 57 seeds)
# Ensures timeout accommodates worst-case: 5s fuzz + 28.5s (57 seeds) + 90s buffer = 123.5s
MAGE_X_FUZZ_MIN_TIMEOUT=120s

# Maximum timeout cap (aligns with MAGE_X_TEST_TIMEOUT to prevent runaway tests)
MAGE_X_FUZZ_MAX_TIMEOUT=30m

# ================================================================================================
# üìå NOTES
# ================================================================================================

# Remember:
# - Keep this file minimal - only override what's necessary
# - Document WHY you're overriding (compatibility, performance, etc.)
# - Use 99-local.env for personal/temporary overrides
